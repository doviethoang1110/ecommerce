<footer class="footer-light">
    <div class="light-layout">
        <div class="container">
            <section class="small-section border-section border-top-0">
                <div class="row">
                    <div class="col-lg-6">
                        <div class="subscribe">
                            <div>
                                <h4>KNOW IT ALL FIRST!</h4>
                                <p>Never Miss Anything From Multikart By Signing Up To Our Newsletter.</p>
                            </div>
                        </div>
                    </div>
                    <div class="col-lg-6">
                        <form
                                action="https://pixelstrap.us19.list-manage.com/subscribe/post?u=5a128856334b598b395f1fc9b&amp;id=082f74cbda"
                                class="form-inline subscribe-form auth-form needs-validation" method="post"
                                name="mc-embedded-subscribe-form" target="_blank">
                            <div class="form-group mx-sm-3">
                                <input type="text" class="form-control" name="EMAIL"
                                       placeholder="Enter your email" required="required">
                            </div>
                            <button type="submit" class="btn btn-solid" >subscribe</button>
                        </form>
                    </div>
                </div>
            </section>
        </div>
    </div>
    <section class="section-b-space light-layout">
        <div class="container">
            <div class="row footer-theme partition-f">
                <div class="col-lg-4 col-md-6">
                    <div class="footer-title footer-mobile-title">
                        <h4>about</h4>
                    </div>
                    <div class="footer-contant">
                        <div class="footer-logo"><img src="../assets/images/icon/logo.png" alt=""></div>
                        <p>Lorem ipsum dolor sit amet, consectetur adipiscing elit, sed do eiusmod tempor incididunt
                            ut labore et dolore magna aliqua. Ut enim ad minim veniam,</p>
                        <div class="footer-social">
                            <ul>
                                <li><a href="#"><i class="fa fa-facebook" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fa fa-google-plus" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fa fa-twitter" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fa fa-instagram" aria-hidden="true"></i></a></li>
                                <li><a href="#"><i class="fa fa-rss" aria-hidden="true"></i></a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col offset-xl-1">
                    <div class="sub-title">
                        <div class="footer-title">
                            <h4>my account</h4>
                        </div>
                        <div class="footer-contant">
                            <ul>
                                <li><a href="#">mens</a></li>
                                <li><a href="#">womens</a></li>
                                <li><a href="#">clothing</a></li>
                                <li><a href="#">accessories</a></li>
                                <li><a href="#">featured</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="sub-title">
                        <div class="footer-title">
                            <h4>why we choose</h4>
                        </div>
                        <div class="footer-contant">
                            <ul>
                                <li><a href="#">shipping & return</a></li>
                                <li><a href="#">secure shopping</a></li>
                                <li><a href="#">gallary</a></li>
                                <li><a href="#">affiliates</a></li>
                                <li><a href="#">contacts</a></li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="col">
                    <div class="sub-title">
                        <div class="footer-title">
                            <h4>store information</h4>
                        </div>
                        <div class="footer-contant">
                            <ul class="contact-list">
                                <li><i class="fa fa-map-marker"></i>Multikart Demo Store, Demo store India 345-659
                                </li>
                                <li><i class="fa fa-phone"></i>Call Us: 123-456-7898</li>
                                <li><i class="fa fa-envelope-o"></i>Email Us: <a href="#">Support@Fiot.com</a></li>
                                <li><i class="fa fa-fax"></i>Fax: 123456</li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>
    <div class="sub-footer">
        <div class="container">
            <div class="row">
                <div class="col-xl-6 col-md-6 col-sm-12">
                    <div class="footer-end">
                        <p><i class="fa fa-copyright" aria-hidden="true"></i> 2017-18 themeforest powered by
                            pixelstrap</p>
                    </div>
                </div>
                <div class="col-xl-6 col-md-6 col-sm-12">
                    <div class="payment-card-bottom">
                        <ul>
                            <li>
                                <a href="#"><img src="../assets/images/icon/visa.png" alt=""></a>
                            </li>
                            <li>
                                <a href="#"><img src="../assets/images/icon/mastercard.png" alt=""></a>
                            </li>
                            <li>
                                <a href="#"><img src="../assets/images/icon/paypal.png" alt=""></a>
                            </li>
                            <li>
                                <a href="#"><img src="../assets/images/icon/american-express.png" alt=""></a>
                            </li>
                            <li>
                                <a href="#"><img src="../assets/images/icon/discover.png" alt=""></a>
                            </li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>
<!-- footer end -->


<!--modal popup start-->
<div class="modal fade bd-example-modal-lg theme-modal" id="exampleModal" tabindex="-1" role="dialog"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body modal1">
                <div class="container-fluid p-0">
                    <div class="row">
                        <div class="col-12">
                            <div class="modal-bg">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                            aria-hidden="true">&times;</span></button>
                                <div class="offer-content"> <img src="../assets/images/Offer-banner.png"
                                                                 class="img-fluid blur-up lazyload" alt="">
                                    <h2>newsletter</h2>
                                    <form
                                            action="https://pixelstrap.us19.list-manage.com/subscribe/post?u=5a128856334b598b395f1fc9b&amp;id=082f74cbda"
                                            class="auth-form needs-validation" method="post"
                                            name="mc-embedded-subscribe-form"
                                            target="_blank">
                                        <div class="form-group mx-sm-3">
                                            <input type="email" class="form-control" name="EMAIL"
                                                   placeholder="Enter your email" required="required">
                                            <button type="submit" class="btn btn-solid">subscribe</button>
                                        </div>
                                    </form>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!--modal popup end-->


<!-- Quick-view modal popup start-->
<div class="modal fade bd-example-modal-lg theme-modal" id="quick-view" tabindex="-1" role="dialog"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content quick-view-modal">
            <div class="modal-body">
                <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                            aria-hidden="true">&times;</span></button>
                <div class="row">
                    <div class="col-lg-6 col-xs-12">
                        <div class="quick-view-img"><img src="../assets/images/pro3/1.jpg" alt=""
                                                         class="img-fluid blur-up lazyload"></div>
                    </div>
                    <div class="col-lg-6 rtl-text">
                        <div class="product-right">
                            <h2>Women Pink Shirt</h2>
                            <h3>$32.96</h3>
                            <ul class="color-variant">
                                <li class="bg-light0"></li>
                                <li class="bg-light1"></li>
                                <li class="bg-light2"></li>
                            </ul>
                            <div class="border-product">
                                <h6 class="product-title">product details</h6>
                                <p>Sed ut perspiciatis, unde omnis iste natus error sit voluptatem accusantium
                                    doloremque laudantium</p>
                            </div>
                            <div class="product-description border-product">
                                <div class="size-box">
                                    <ul>
                                        <li class="active"><a href="#">s</a></li>
                                        <li><a href="#">m</a></li>
                                        <li><a href="#">l</a></li>
                                        <li><a href="#">xl</a></li>
                                    </ul>
                                </div>
                                <h6 class="product-title">quantity</h6>
                                <div class="qty-box">
                                    <div class="input-group"><span class="input-group-prepend"><button type="button"
                                                                                                       class="btn quantity-left-minus" data-type="minus" data-field=""><i
                                                        class="ti-angle-left"></i></button> </span>
                                        <input type="text" name="quantity" class="form-control input-number"
                                               value="1"> <span class="input-group-prepend"><button type="button"
                                                                                                    class="btn quantity-right-plus" data-type="plus" data-field=""><i
                                                        class="ti-angle-right"></i></button></span></div>
                                </div>
                            </div>
                            <div class="product-buttons"><a href="#" class="btn btn-solid">add to cart</a> <a
                                        href="#" class="btn btn-solid">view detail</a></div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Quick-view modal popup end-->




<!-- exit modal popup start-->
<div class="modal fade bd-example-modal-lg theme-modal exit-modal" id="exit_popup" tabindex="-1" role="dialog"
     aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-body modal1">
                <div class="container-fluid p-0">
                    <div class="row">
                        <div class="col-12">
                            <div class="modal-bg">
                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                    <span aria-hidden="true">&times;</span>
                                </button>
                                <div class="media">
                                    <img src="../assets/images/stop.png"
                                         class="stop img-fluid blur-up lazyload mr-3" alt="">
                                    <div class="media-body text-left align-self-center">
                                        <div>
                                            <h2>wait!</h2>
                                            <h4>We want to give you
                                                <b>10% discount</b>
                                                <span>for your first order</span>
                                            </h4>
                                            <h5>Use discount code at checkout</h5>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<!-- Add to cart modal popup end-->


<!-- facebook chat section start -->
<div id="fb-root"></div>
<script>(function (d, s, id) {
        var js, fjs = d.getElementsByTagName(s)[0];
        if (d.getElementById(id)) return;
        js = d.createElement(s); js.id = id;
        js.src = 'https://connect.facebook.net/en_US/sdk/xfbml.customerchat.js#xfbml=1&version=v2.12&autoLogAppEvents=1';
        fjs.parentNode.insertBefore(js, fjs);
    }(document, 'script', 'facebook-jssdk'));</script>
<!-- Your customer chat code -->
<div class="fb-customerchat" attribution=setup_tool page_id="2123438804574660" theme_color="#0084ff"
     logged_in_greeting="Hi! Welcome to PixelStrap Themes  How can we help you?"
     logged_out_greeting="Hi! Welcome to PixelStrap Themes  How can we help you?">
</div>
<!-- facebook chat section end -->


<!-- cart start -->
<div class="addcart_btm_popup" id="fixed_cart_icon">
    <a href="/gio-hang" class="fixed_cart">
        <i class="ti-shopping-cart"></i>
        <span id="cartSize"></span>
    </a>
</div>
<!-- cart end -->


<!-- tap to top -->
<div class="tap-top top-cls">
    <div>
        <i class="fa fa-angle-double-up"></i>
    </div>
</div>
<!-- tap to top end -->


<!-- latest jquery-->
<script src="../assets/js/jquery-3.3.1.min.js"></script>

<!-- fly cart ui jquery-->
<script src="../assets/js/jquery-ui.min.js"></script>

<!-- exitintent jquery-->
<script src="../assets/js/jquery.exitintent.js"></script>
<script src="../assets/js/exit.js"></script>

<!-- popper js-->
<script src="../assets/js/popper.min.js"></script>

<!-- slick js-->
<script src="../assets/js/slick.js"></script>

<!-- menu js-->
<script src="../assets/js/menu.js"></script>

<!-- lazyload js-->
<script src="../assets/js/lazysizes.min.js"></script>

<!-- Bootstrap js-->
<script src="../assets/js/bootstrap.js"></script>

<!-- Bootstrap Notification js-->
<script src="../assets/js/bootstrap-notify.min.js"></script>

<!-- Fly cart js-->
<script src="../assets/js/fly-cart.js"></script>

<!-- Theme js-->
<script src="../assets/js/script.js"></script>
<script src="../assets/js/jquery.ba-throttle-debounce.js"></script>
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@10"></script>
<script>
    $("#result").fadeOut();
    Array.prototype.limit = function limit(c){
        return this.filter((x, i) => {
            if(i <= (c - 1)) return true;
        })
    };
    function toast(icon,title) {
        const Toast = Swal.mixin({
            toast: true,
            position: 'top-end',
            showConfirmButton: false,
            timer: 1000,
            timerProgressBar: true
        })
        return Toast.fire({icon, title})
    }

    const listCart = JSON.parse(localStorage.getItem("listCart")) ? JSON.parse(localStorage.getItem("listCart")) : [];
    let url = window.location.protocol+'//'+window.location.host;
    let currencies = '<%- JSON.stringify(currencies) %>';
    let currency = localStorage.getItem("currency") ? JSON.parse(localStorage.getItem("currency")) : JSON.parse(currencies)[0];
    $(document).ready(function () {
        getCartNumber();
        for (let i = 0; i < $('.currencies').length; i++)
            if(+$($('.currencies')[i]).attr('id') === +currency.id) {
                $($('.currencies')[i]).css("background-color","aqua")
                break;
            }
        $(document).on('click','.currencies',function (e) {
            e.preventDefault();
            currency = JSON.parse(currencies).find(c => +c.id === +$(this).attr('id'));
            localStorage.setItem("currency",JSON.stringify(currency));
            $('.currencies').css("background-color","");
            $(this).css("background-color","aqua");
            setTimeout(() => window.location.reload(), 0);
        });

        $(document).on('click',"div.close-circle a",function (event) {
            event.preventDefault();
            removeCart($(this).parent().parent().attr('id'));
        });

        if(listCart.length) addTopCart();
        else $("#listCart").html("<li><h4>Chưa có sản phẩm nào</h4></li>");

        $("#logout").click(function (event) {
            event.preventDefault();
            $.ajax({
                url: url+"/dang-xuat",
                method: "DELETE",
                success:function () {
                    window.location.href = "http://localhost:4200"
                },
                error:function (error) {
                    $("#error_message").text(error.responseJSON)
                }
            })
        });
        $("#search").on('keyup', $.debounce(350, function (event) {
            event.preventDefault();
            if(event.target.value){
                $.ajax({
                    url: `${url + "/tim-kiem?key=" + event.target.value}`,
                    method:"GET",
                    success:function (response) {
                        $("#result").html("");
                        if(response.length>0){
                            response.forEach(pro=>{
                                $("#result").append(`
                            <a href="/products/${pro.slug}" style="padding: 20px">
                                <div class="row">
                                    <img class="col-md-4" src="/uploads/${pro.image}"/>
                                    <span class="col-md-8">
                                        <span style="display:block">${pro.name}</span>
                                        <span style="display:block">
                                            ${formatMoney(pro.priceFrom)}-
                                            ${formatMoney(pro.priceTo)}
                                        </span>
                                    </span>
                                </div>
                            </a>
                        `);
                            });
                        }else $("#result").html("<h3>Không có sản phẩm phù hợp</h3>");
                    },
                    error:function (error) {
                        console.log(error);
                        $("#result").html("<h3>Không có sản phẩm phù hợp</h3>");
                    }
                })
                $("#result").fadeIn();
            }else{
                $("#result").html("");
                $("#result").fadeOut();
                return false;
            }
        }));
    });

    function formatDate(date) {
        return new Intl.DateTimeFormat('en', { year: 'numeric',month: 'short',day: '2-digit' }).format(date)
    }

    function formatMoney(money) {
        let cash = currency.rate !== 1 ? money/currency.rate/1000 : money/currency.rate;
        return new Intl.NumberFormat('en-US',{ style: 'currency', currency: currency.code }).format(Math.round(cash));
    }

    function calTotal(){
        let total = listCart.reduce((total,cart) => {
            return total += cart.price * cart.quantity
        },0);
        return Math.round(total);
    }

    function getCartNumber() {
        let number = 0;
        listCart.forEach(c => number += +c.quantity);
        $("#cartSize").text(number);
    }

    function addTopCart() {
        $("#listCart").html("");
        listCart.forEach(c => {
            $("#listCart").append(`
                <li id="${c.id}" content="${c.id}">
                    <div class="media">
                        <a href="#"><img class="mr-3" src="/uploads/${c.image}" alt="Generic placeholder image"></a>
                            <div class="media-body">
                                    <a href="#"><h4>${c.name}</h4></a>
                                    <span>${c.id}</span>
                                    <h4><span>${c.quantity} x `+formatMoney(c.price)+`</span></h4>
                            </div>
                    </div>
                    <div class="close-circle">
                        <a href="#"><i class="fa fa-times" aria-hidden="true"></i></a>
                    </div>
                </li>
            `);
        });
        $("#listCart").append(`
                <li>
                    <div class="total">
                        <h5>subtotal : <span>`+formatMoney(calTotal())+`</span></h5>
                    </div>
                </li>
                <li>
                    <div class="buttons">
                        <a href="/gio-hang" class="view-cart">view cart</a>
                        <a href="/thanh-toan" class="checkout">checkout</a>
                    </div>
                </li>
            `);
    }

    function removeCart(id){
        if(confirm("Bạn chắc không ?")){
            let cart = listCart.find(c => c.id === id);
            toast("success","Xóa thành công");
            listCart.splice(listCart.indexOf(cart),1);
            localStorage.setItem("listCart", JSON.stringify(listCart));
            $(`#${id}`).remove();
            $(`tbody[content='${id}']`).remove();
            getCartNumber();
            if(!listCart.length){
                $("#listCart").html("<h4>Chưa có sản phẩm nào</h4>");
                $("#cartView").html("<h2>Chưa có sản phẩm nào</h2>");
            }
            else $("div.total h5 span").text(formatMoney(calTotal()));
        }else return;
    }
</script>